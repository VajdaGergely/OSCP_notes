# Compiling guide (and other things)
## Legfontosabb dolgok
* Windows developer image-et kezdjuk el hasznalni
* Alapvetoen olyan boxokat toljak, amin uj OS-ek vannak (Win7-tol folfele)
* Windows Kernel exploitokat le-compile-olni egyesevel (Uj Windows-okra, ne a regiekre)
  * Legyen belole egy tablazat, es mentsuk le oket valahova, hogy meg legyenek
  * kb 80 darab van
* Arch Linux kornyezetet egyszer osszerakni egyedul
* Ezt az egy gepet - Optimum - mar csinaljam meg ha elkezdtem
  * WinDbg-vel meg tudom nezni hogy miert nem megy az exploit - sima Windows-on (Win10en)
* Windows-os exploitokat eleve Windows-on compile-oljuk, mert az jobban fog mukodni!
* WinDbg-t megismerni jobban
* Aktiv gepek is mehetnek, retired gepek is mehetnek, (retiredbol az ujakkal jobban jarok, es a regiekkel meg erdemes kesobb mert azokkkal szopas lesz az exploit compiling, meg a futtatas is)
## Windows developer image
### info
* elore fel van ra telepitve egy csomo cucc - pl VS
* tobbnyire rendesen mukodik
* regi exploitoknal lehet vele gond esetleg
### guide
* source: https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/
* image content
  * Windows 11 Enterprise (Evaluation)
  * Visual Studio 2022 Community Edition with UWP, .NET Desktop, Azure, and Windows App SDK for C# workloads enabled
  * Windows Subsystem for Linux 2 enabled with Ubuntu installed
  * Windows Terminal installed
  * Developer mode enabled
## Compile on windows
* alapvetoen ezeket hasznaljuk: VS, codeblocks
* codeblocks
  * azert jo mert az open source cuccokat konnyebb bekonfigolni (az IDE-n keresztul)
  * egyszerubb rajta exploit-ot compile-olni
* VS
  * hogyha azt latjuk, hogy Visual C++-al kell compile-olni valamit, meg MSVC linker-t kell hozza hasznalni
    * akkor VS-el compile-oljuk majd
  * eloszor csinaljunk egy sima Windows Console Projectet (ne empty-t)
    * adjunk hozza egy uj source file-t (legyen a kiterjesztese C es ne Cpp)
    * legyen benne egy sima main()
    * ha ez lefordul, akkor utana rakjuk bele az exploit kodot
  * Build tools-t felejtsuk el - a sima rendes VS-t hasznaljuk
    * Hozzadjuk a cuccokat amik kellenek - vagy az elejen egybol vagy utkozben (desktop development, C++ console development, etc...)
* VS + codeblocks egyszerre felrakva
  * kornyezeti valtozokkal kell jatszani batch file-bol, hogy ne akadjanak ossze egymassal
* x86 vs x64
  * exploit-nal nagyon nem mindegy
  * szamit hogy mire forditom le
  * nem igaz, hogy 64 biten elfut akkor is ha 32-re es akkor is ha 64-re compile-ololom a C kodot peldaul
* Ökölszabály hogy a Windows-os dolgokat jobb Windows-on fordítani
  * nehéz ott is összerakni és ott is lesz vele szopás
  * egyszerűbb a vm
  * az lesz a nehéz hogy hogy rakok össze olyan projectet ami jó lesz
* Msdn lib-ek -> a compiler switchekkel tudom oket allitgatni
* MS csinalt kiegeszitest a C nyelvhez, es az MS compiler ezt erti is, de ezt a tobbi compiler nem hasznalja, es ezert azokkal nem is fog mukodni
## Visual Studio vagy Visual Studio Build Tools
* a Build Tools-t hagyjuk
* hasznaljuk a rendes Visual Studio-t
## Local-ba megcsinalni egy vm-et pont ugyanolyanra mint a target gep
* hasznos lehet vegso soron hogyha nem mukodik sehogy sem az exploit
* es akkor azon lehet WinDbg-vel pl debuggolni hogy mi a szarert nem mukodik
## Exploits for Linux vs exploits for Windows
* **Linux**
  * gcc-t felrakjuk
  * megfelelo lib-eket leszedjuk
  * mukodik minden faszan
  * **A windows nem ilyen!!**
* **Windows**
  * projecteket kell csinalni
  * sokfajta modon lehet konfigolni a kornyezetet, a compilert
  * van hogy egyszer kell egy projecthez megcsinalni a konfigot es akkor azzal utana tobb exploitot is le tudok majd compile-olni
  * sokszor nem a kod szar, hanem a project beallitas
  * mingw-vel sok minden mukodik, de van hogy egy remalom megcsinalni
* Cross-compiling from Linux to Windows
  * kalirol nem biztos hogy minden mukodni fog
  * multilib-eket mindenkepp szedjuk le, mert az kelleni fog
  * Ubuntu-t is meg lehet probalni, azon kicsit jobban megy mint kalin, meg jo forumok vannak hozza, ahol leirjak, hogy hogy compile-oljak
  * Ha sehogy nem megy, akkor meg atmegyek megis Windows-ra
## OSCP gepek
* OSCP-n nincsen XP meg hasonlo regi OS-ek
* nem baj ha ezekkel is foglalkozok
* de ne ezekkel foglalkozzak foleg
* a linkedin-es OSCP HTB lista nem az igazi, engedjuk el egyelore
## Kornyezetek, amiket felepitek
* Nem tudom meguszni az alabbiakat
  * virtual env-ek hasznalata
  * docker
  * vm
  * komplett megegyezo kornyezetet felepiteni
* Csinalhatok olyat hogy sok VM-et csinalok hogy legyen sok build kornyezet
* A webes feladatoknal még mukodott az hogy
  * 1 kali, 1 target van
* A windows exploitoknal meg AD-nal mar sok gep kell
## Arch Linux kornyezet
* vm legyen
* kezzel rakjam ossze
* felrakni ra azokat a tool-okat, amiket amugy hasznalok pentesteleshez
  * jobban megertem majd hogy hogyan mukodnek
* mukodjon a copy - paste
* mappat lehessen felmappelni
* tool-okat felrakni (gobuster, stb...)
* verziok is fontosak, hogy melyiket rakjuk fel!!!
## Exploit-ok a neten
* sok a szar kozottuk
* az exploitdb-sek be kb mindig bele kell nyulni valahol hogy mukodjenek
## winlibs.com
* fent vannak runtime-ok
* fent vannak kulonbozo esetek
* ahol az van hogy 'windows only' ott azt linuxrol nem tudom hasznalni a compile-hoz
## Ha van release file
* nezzuk meg hatha latszik, hogy mivel lett compile-olva
* linux file command, vagy megnezzuk a source kodot, vagy ha vannak mas file-ok is mellette, akkor nezzuk meg azt is
  * pl pdb file -> visual studio debugger file -> akkor ha van ilyen, akkor VS-el compile-oljuk Windows alol
## Github
* egyedi sajat keszitesu cuccot ne rakjak fel, mert lenyuljak (akkor is hogyha privat a repo)
* ha exploit-ot rakok fel, van hogy letiltja, van hogy nem (akar binaris, akar source)
## Kali
* egyre szarabb
* mindegy hogy regi vagy uj verziot szedek le
