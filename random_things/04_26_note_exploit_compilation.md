# 04.26 note - exploit compilation
<pre>
lokalba megcsinalni a vm-et ugyanugy mint a target


windows compile rendszeret megismerni
"windows developer image"
-minden szar rajta van
->raguglizok...
minden van rajta, .net, vs...

alapbol ez mukodik
van amikor szar


regi exploitok-nal neha nem megy




linux
gcc
lib
mukodik faszan
MS nem igy mukodik


projecteket kell csinalni
sokfajta a konfigja
sokszor egyszer kell megcsinalni egy configot egy console projecthez
hogy lefusson egy exploit
es akkor oda tudom pakolgatni a c kodot

sokszor nem a kod a szar hanem a project beallitas


remalom
mingw-vel lehet bohockodni
sok minden mukodik vele
de ez mindig szopás lesz
--version meg tudom nezni a verziot mindenhez
pythonhoz pl meg tudom nezni

lib-ek incompatibilisek




oscp
nincs xp
hagyjam ezeket a gepeket alapvetoen
nem baj ha csinalom de ne ezekkel foglalkozzak alapbol



nem tudom meguszni hogy
-virtual env-eket használjak
-docker
-vm
-komplett megegyezo kornyezetet felepiteni


összeepiteni egy arch-os image-et
-tool-okat felrakni rá egyesével
jobban megértem majd hogy mi hogyan működik


arch linuxot csinálni
vm legyen
kézzel rakjam össze
amit akarok azt használhatok rajta
és utána azt kell használnom a tesztekhez
működjön a copy paste
mappat lehessen felmapp-elni
tool-okat felrakni
-gobuster, stb...
verziók...
-->jobban megértem hogy hogy működik, azért kell ez
(gentot használt de az még szarabb...)
(legdurvább az lfs linux...az még durvábbb)


1 kali 1 target
-a webes világig működik
utána windows-nál már nem
AD-nál már végképp nem megy
-ott lehet windowsra kell átmenni



összes windows kernel exploitot összegyűjteni
lefordítani
csinálni róla egy táblázatot



sok a szar exploit neten



exploitdb - kb bármit szedek le, abba mindig bele kell nyúlni kicsit



arch linuxot használjak kali helyett mindenre??


nem attol leszek jo hogy van oscp-m
az anyag a lényeg, ami mögötte van
meg kell tanulni ezt a sok szart
nem a vizsgától leszek jó
vagy nem az a lényeg, hogy 70 gépem van meg



nem szeret walkthrough-zni
van hogy 2 hét után megnézi a walkthrough-t, nem a teljes megoldást nézi hanem csak hogy jó úton jár e





hacker közösségben ha benne vagyok
-vannak mások is akiknek van ilyen problémája
-tudunk beszélgetni egymással, az jót tesz
-aki nálam tapasztaltabb azzal tudok beszélni


híreket olvasni, infókat összegyűjteni
-discord hackthebox fórum
-offsec fórum

egy idő után nem tudom ezeket kihagyni, hanem szükség lesz rá





megtanulni keresni
ha csinálok valamit és nem megy - akkor átváltani más megoldásra
-lehet hogy windows-on megy majd vagy nem


----
ezt az egy gépet már csináljam meg ha már elkezdtem

vm-et rakjak össze
nézzem meg hogy windows-on megy e
win10 + VS környezet



arch linux?
régi gépek?


ne higyjek annak aki azt mondja, hogy egyből sikerült neki minden


régi gépek
-ha találok rá jó exploitot akkor jó vagyok
-második téma hogy tudom ezeket lefordítani
szerinte
ubuntun szoktak jól működni a compile-ok
ubuntu-s fórumokon talál jó megoldásokat

MS16-135
szar a környezet ahol buildelek


sok vm lehet több OS-hez
-nyugodtan csinálhatok ilyet



oscp-hez ő az összes kernel exploitot le-compile-olta
-kb 80 darab van

github-ra egyedi cuccot ne rakjak fel
saját exploit-okat felrakhatok binárist is
valami fasza helyet kéne találni ezeknek a cuccoknak
-git lehet hogy letiltja ezeket
host gépen meg a virusirtónak nem fog tetszeni

kéne valami fasza megoldás erre...



arch
-csak az összerakás a lényeg
-de amúgy kaliról dolgozzak



találni közösséget erre a dologra
-



winlibs.com
csomo eset
csomo letoltheto dolog

download
runtime-ok for windows only

lehet hogy ha nem mukodik linuxon, akkor windows-on kell csinalni
és pl innen tudom leszedni a runtime-ot


windows-on compile-olni
VS
codeblocks - ez is jó!!
-open source szarokat könnyű bekonfigurlálni ezért jók
-IDE-n keresztül
-egyszerűbbek exploit compile-hoz

VS + codeblocks
-ott is környezeti változókkal kell batch file-ból szórakozni hogy ne akadjanak össze

32 vs 64 bit
exploit-nál nagyon nem mindegy
számít hogy mire fordítom le

kali egyre szarabb
mindegyik szar


exegol?? - docker ubuntu-n
parrot linux








multilib
-arra jó hogy más platform-ra is tudjak fordítani



ha msf-el működik az exploitation
-átírni saját binárisra??



1. probaljuk meg kalin vagy ubuntun compile-olni
2. ha nagyon nem megy rajta, akkor próbáljuk meg windows-on (sima win10)
   -lehet visual studioval
   -vagy codeblocks-al
   (codeblocks-ot könnyebb)






---
41015.c

f exceptions??

neki se sikerült kali-n
azt mondja valszeg windows-on kéne csinálni


megoldas
-mingw	mint compiler
 -a seh-et nem supportalja
nem fog mukodni

clang-al forditsak, azt javasoljak


github.com/eclipse/omr/issues/2370

ezen a ponton megyunk at windowsra


valaki nem tudok mingw-el forditani mar windows-on se


clang compiler

msys lib -el se ment valakinek



ökölszabály
-a windows-os dolgokat jobb windows-on fordítani
nehéz ott is összerakni és ott is lesz vele szopás
egyszerűbb a vm
az lesz a nehéz hogy hogy rakok össze olyan projectet ami jó lesz


ELEVE WINDOWS-OS CSINÁLJAM

megismerni
-winDbg

msdn libek - compiler switchekkel tudom ezeket állítgatni
(pl safeseh:no kapcsolo) (/safeseh)


ms csinalt kiegeszitest a c nyelvhez
a tobbi compiler nem hasznalja ezt



https://learn.microsoft.com/en-us/cpp/build/reference/safeseh-image-has-safe-exception-handlers?view=msvc-170

Visual C++

visual studio

msvc linker kell


codeblocks-ot most hagyhatjuk a francba



vs
-windows console project (ne empty)
az lefordul e önmagában - sima main-el

utána belerakjuk az exploit



linkedin lista csupa régi gépet tartalmaz
-kevésbé releváns gépek oscp szempontjából




file command az exe fájlra, release-t megnézni rendesen
-lehet hogy látszik belőle hogy mivel lett compile-olva!!!
pl pdb fájl ha van -> az visual studio debug fájl



Windows Developer Image!!!
ott van feltelepitve ra a VS meg egy csomó minden
és az működik is rendesen!!!


ő VS build tools-t nem nagyon használ kb soha.
Csak a sima rendes VS-t használja


active gépeket is tolhatok
-nem csak a retired gépeket

retired gépekből az újabbak valszeg jobbak nekem, mert ott nem ezeréves gépekkel kell tolni, hanem win7, win10, stb...
</pre>
